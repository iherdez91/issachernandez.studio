{{ define "main" }}
<div class="riff-library-container">
  <!-- Sidebar with all categories -->
  <aside class="riff-sidebar">
    <h3>Categories</h3>
    <ul class="filter-list">
      {{ range .Site.Taxonomies.categories }}
        <li><a href="{{ .Page.Permalink }}">{{ .Page.Title }} ({{ .Count }})</a></li>
      {{ end }}
    </ul>
  </aside>

  <main class="riff-main">
    <!-- Back Button -->
    <a href="/riff-library/" class="riff-back-btn">‚Üê Back to Riff Library</a>

    <header>
      <h1 class="text-4xl font-extrabold text-neutral-900 dark:text-neutral">Category: {{ .Title }}</h1>
    </header>

    {{ $pages := .Pages }}
    {{ $paginator := .Paginate $pages 9 }}

    <section class="riff-grid">
      {{ range $paginator.Pages }}
        {{ $postTitle := .Title }}
        <article class="riff-card">
          <a href="{{ .Permalink }}">
            <div class="riff-thumbnail">
              {{ with .Params.videoID }}
                {{ $parts := split . "/" }}
                {{ $libraryID := index $parts 0 }}
                {{ $videoGUID := index $parts 1 }}
                <img src="https://vz-{{ $libraryID }}.b-cdn.net/{{ $videoGUID }}/thumbnail.jpg" alt="{{ $postTitle }}" loading="lazy">
              {{ else }}
                <div class="riff-placeholder">üé∏</div>
              {{ end }}
            </div>
            <div class="riff-info">
              <h2>{{ .Title }}</h2>
              {{ with .Params.categories }}
                <span class="riff-category">{{ index . 0 }}</span>
              {{ end }}
            </div>
          </a>
        </article>
      {{ end }}
    </section>

    <!-- Pagination -->
    {{ if gt $paginator.TotalPages 1 }}
    <nav class="riff-pagination">
      {{ if $paginator.HasPrev }}
        <a href="{{ $paginator.Prev.URL }}" class="pagination-btn">‚Üê Previous</a>
      {{ end }}
      <span class="pagination-info">Page {{ $paginator.PageNumber }} of {{ $paginator.TotalPages }}</span>
      {{ if $paginator.HasNext }}
        <a href="{{ $paginator.Next.URL }}" class="pagination-btn">Next ‚Üí</a>
      {{ end }}
    </nav>
    {{ end }}
  </main>
</div>
{{ end }}
